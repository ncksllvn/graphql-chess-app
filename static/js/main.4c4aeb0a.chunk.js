(this["webpackJsonpgraphql-chess-app"]=this["webpackJsonpgraphql-chess-app"]||[]).push([[0],{18:function(e,n,t){e.exports=t(33)},29:function(e,n,t){},30:function(e,n,t){},31:function(e,n,t){},33:function(e,n,t){"use strict";t.r(n);var a,r,c,o,s,i,u,l=t(0),f=t.n(l),b=t(8),p=t.n(b),d=t(4),m=t(3),v=t(16),h=(t(29),t(30),t(31),t(1)),O="chess-and-constants/REQUEST",j="chess-and-constants/RECEIVE",E="chess-and-constants/FAILURE",y="move/REQUEST",C="move/RECEIVE",g="move/FAILURE",k="BLACK",S="WHITE",I="KING",q="QUEEN",A="ROOK",N="BISHOP",w="KNIGHT",L="PAWN",P=(u={},Object(h.a)(u,I,(a={},Object(h.a)(a,k,"\u265a"),Object(h.a)(a,S,"\u2654"),a)),Object(h.a)(u,q,(r={},Object(h.a)(r,k,"\u265b"),Object(h.a)(r,S,"\u2655"),r)),Object(h.a)(u,A,(c={},Object(h.a)(c,k,"\u265c"),Object(h.a)(c,S,"\u2656"),c)),Object(h.a)(u,N,(o={},Object(h.a)(o,k,"\u265d"),Object(h.a)(o,S,"\u2657"),o)),Object(h.a)(u,w,(s={},Object(h.a)(s,k,"\u265e"),Object(h.a)(s,S,"\u2658"),s)),Object(h.a)(u,L,(i={},Object(h.a)(i,k,"\u265f"),Object(h.a)(i,S,"\u2659"),i)),u),T=k,R="\n  fragment ChessAttributes on Chess {\n      analysis {\n        bestMove {\n          from\n          to\n          flags\n        }\n        ponderMove {\n          from\n          to\n          flags\n        }\n      }\n      board {\n        rank\n        squares {\n          file\n          piece {\n            type\n            color\n          }\n        }\n      }\n      fen\n      gameOver\n      inCheck\n      inCheckmate\n      inDraw\n      inStalemate\n      insufficientMaterial\n      inThreefoldRepetition\n      moves {\n        color\n        from\n        to\n        promotion\n        flags\n      }\n      turn\n  }\n",B="\n  ".concat(R,"\n\n  fragment ColorConstants on Constants {\n    BLACK\n    WHITE\n  }\n\n  fragment PieceConstants on Constants {\n    BISHOP\n    KING\n    KNIGHT\n    PAWN\n    QUEEN\n    ROOK\n  }\n\n  fragment FlagConstants on Constants {\n    FLAGS {\n      NORMAL\n      CAPTURE\n      BIG_PAWN\n      EP_CAPTURE\n      PROMOTION\n      KSIDE_CASTLE\n      QSIDE_CASTLE\n    }\n  }\n\n  {\n    chess {\n      ... ChessAttributes\n    }\n\n    colorConstants: constants {\n      ... ColorConstants\n    }\n\n    pieceConstants: constants {\n      ... PieceConstants\n    }\n\n    flagConstants: constants {\n      ... FlagConstants\n    }\n  }\n"),x="\n  ".concat(R,"\n\n  mutation makeMove($fen: String!, $move: MoveObjectInput!){\n    chess: move (input: {\n      fen: $fen,\n      move: $move\n    }) {\n      ... ChessAttributes\n    }\n  }\n");function M(e){return{type:"PIECE_SELECTED",squareId:e}}function _(e,n){return Object(h.a)({},"CALL_API",{query:x,variables:{fen:e,move:n},types:[y,C,g]})}var K=k;function U(e){var n=e.typeName,t=e.colorName,a=P[n][t],r="chess-board-piece".concat(t===K?" chess-board-piece--black":"");return f.a.createElement("span",{role:"presentation",className:r},a)}function W(e){var n=e.dark,t=e.isActive,a=e.isTargeted,r=e.onClick,c=e.ariaLabel,o=e.piece,s=["chess-board-square"];return n&&s.push("chess-board-square--dark"),a&&s.push("chess-board-square--targeted"),t&&s.push("chess-board-square--active"),f.a.createElement("button",{type:"button","aria-label":c,disabled:!r,className:s.join(" "),onClick:r},o&&f.a.createElement(U,{typeName:o.typeName,colorName:o.colorName}))}function D(){var e=Object(m.b)(),n=Object(m.c)((function(e){return e.chess})),t=Object(m.c)((function(e){return e.constants})),a=Object(m.c)((function(e){return e.ui}));if(!n)return null;var r=t.piecesBySymbol,c=t.colorsBySymbol,o=t.pieceConstants,s=a.selectedSquareId,i=n.fen,u=n.squares,l=n.movesBySquare,b=n.turn,p=null,d=null;s&&(p=l[s],d=new Set(p.map((function(e){return e.to}))));var v=["chess-board"];return c[b]===k&&v.push("chess-board--black-turn"),f.a.createElement("div",{className:v.join(" ")},u.map((function(n){var t,a,u=n.rank,b=n.file,m=n.piece,v=n.dark,h="".concat(b).concat(u),O=null,j=null,E=null,y=!1,C=!1,g=null,k="".concat(h," is empty"),S=null;m&&(j=r[m.type],E=c[m.color],S="".concat(E," ").concat(j).toLowerCase(),O=l[h],k="".concat(h," contains a ").concat(S),(null===(t=O)||void 0===t?void 0:t.length)>0&&(g=function(){return e(M(h))}));s&&(h===s?(C=!0,k="".concat(h," contains a ").concat(S," selected for move."," "," Use the tab keys to select a square to initiate move."," "," Press again to cancel selection.")):(null===(a=d)||void 0===a?void 0:a.has(h))&&(y=!0,k="Move to ".concat(h),g=function(){var n=p.find((function(e){return e.to===h})),t=n.from,a=n.to,r=n.promotion;r&&(r=o[q]),e(_(i,{from:t,to:a,promotion:r}))}));var I={key:h,dark:v,isActive:C,isTargeted:y,ariaLabel:k,piece:m&&{typeName:j,colorName:E},onClick:g};return f.a.createElement(W,I)})))}function F(){return Object(m.c)((function(e){return e.appStatus})).loading?f.a.createElement("div",{className:"spinner"},f.a.createElement("div",{className:"spinner-icon"})):null}function G(){var e=Object(m.b)();return Object(l.useEffect)((function(){e(Object(h.a)({},"CALL_API",{query:B,types:[O,j,E]}))}),[e]),f.a.createElement(f.a.Fragment,null,f.a.createElement(D,null),f.a.createElement(F,null))}var H={loading:!0};var Q=t(17),$=t(2);function J(e){var n=function(e){return e.moves.reduce((function(e,n){var t=e[n.from]||[];return Object($.a)(Object($.a)({},e),{},Object(h.a)({},n.from,[].concat(Object(Q.a)(t),[n])))}),{})}(e),t=function(e){return e.board.reduce((function(e,n){var t=n.rank,a=n.squares.map((function(e,n){var a=e.file,r=e.piece;return{rank:t,file:a,piece:r,dark:t%2?!(n%2):n%2}}));return e.concat(a)}),[])}(e);return Object($.a)(Object($.a)({},e),{},{squares:t,movesBySquare:n})}var V=t(7);var z={selectedSquareId:null};var X=Object(d.combineReducers)({appStatus:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:H,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case O:case y:return{loading:!0};case C:case j:return{loading:!1};case E:return{loading:!1,errors:n.errors};default:return e}},chess:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case j:case C:return J(n.data.chess);default:return e}},constants:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case j:var t=n.data,a=t.pieceConstants,r=t.colorConstants,c=t.flagConstants,o=Object.entries(a).reduce((function(e,n){var t=Object(V.a)(n,2),a=t[0],r=t[1];return Object($.a)(Object(h.a)({},r,a),e)}),{}),s=Object.entries(r).reduce((function(e,n){var t=Object(V.a)(n,2),a=t[0],r=t[1];return Object($.a)(Object(h.a)({},r,a),e)}),{});return{piecesBySymbol:o,colorsBySymbol:s,pieceConstants:a,colorConstants:r,flagConstants:c};default:return e}},ui:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:z,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case"PIECE_SELECTED":var t=n.squareId;return t===e.selectedSquareId?Object($.a)(Object($.a)({},e),{},{selectedSquareId:null}):Object($.a)(Object($.a)({},e),{},{selectedSquareId:t});case C:return Object($.a)(Object($.a)({},e),{},{selectedSquareId:null});default:return e}}}),Y=t(5),Z=t.n(Y),ee=t(10),ne={"Content-Type":"application/json"};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var te=[function(){return function(e){return function(){var n=Object(ee.a)(Z.a.mark((function n(t){var a,r,c,o,s,i,u,l,f,b,p,d,m,v,h;return Z.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t.CALL_API){n.next=2;break}return n.abrupt("return",e(t));case 2:return a=t.CALL_API,r=a.query,c=a.variables,o=Object(V.a)(a.types,3),s=o[0],i=o[1],u=o[2],l={query:r,variables:c},f=JSON.stringify(l),b={method:"POST",headers:ne,body:f},e({type:s,data:{query:r,variables:c}}),n.prev=7,n.next=10,fetch("https://fast-castle-57354.herokuapp.com",b);case 10:if(!(p=n.sent).ok){n.next=20;break}return n.next=14,p.json();case 14:d=n.sent,m=d.data,v=d.errors,m&&e({type:i,data:m}),v&&e({type:u,errors:v}),n.next=21;break;case 20:throw new Error("Response not ok");case 21:n.next=28;break;case 23:n.prev=23,n.t0=n.catch(7),h=n.t0,n.t0 instanceof Error&&(h={name:n.t0.name,message:n.t0.message,stack:n.t0.stack}),e({type:u,errors:[h]});case 28:case"end":return n.stop()}}),n,null,[[7,23]])})));return function(e){return n.apply(this,arguments)}}()}},function(e){return function(n){return function(){var t=Object(ee.a)(Z.a.mark((function t(a){var r,c,o,s,i,u,l,f;return Z.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n(a),a.type!==C){t.next=8;break}if(r=e.getState(),c=r.constants.colorConstants,o=r.chess,s=o.fen,i=o.turn,u=o.analysis.bestMove,l=u.from,f=u.to,i!==c[T]){t.next=8;break}return e.dispatch(M(l)),t.next=7,new Promise((function(e){return setTimeout(e,1e3)}));case 7:e.dispatch(_(s,{from:l,to:f}));case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}],ae=Object(v.composeWithDevTools)(d.applyMiddleware.apply(void 0,te)),re=Object(d.createStore)(X,ae);p.a.render(f.a.createElement(f.a.StrictMode,null,f.a.createElement(m.a,{store:re},f.a.createElement(G,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[18,1,2]]]);
//# sourceMappingURL=main.4c4aeb0a.chunk.js.map